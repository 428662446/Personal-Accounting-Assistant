# ä¸ªäººè®°è´¦åŠ©æ‰‹ (Personal Accounting Assistant)

> Tokenå›¢é˜Ÿ2025è€ƒæ ¸é¡¹ç›® - ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„å¤šç”¨æˆ·è®°è´¦ç³»ç»Ÿ

## ğŸ¯ é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªåŸºäºGoè¯­è¨€å’ŒGinæ¡†æ¶å¼€å‘çš„ä¸ªäººè®°è´¦åŠ©æ‰‹ï¼Œå®Œæˆäº†é¢˜ç›®è¦æ±‚çš„åŸºç¡€åŠŸèƒ½ï¼Œåœ¨å®‰å…¨æ€§ã€æ¶æ„è®¾è®¡å’Œæ‰©å±•æ€§æ–¹é¢åšäº†æ·±å…¥æ€è€ƒå’Œå®è·µ

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ« åŸºç¡€åŠŸèƒ½
- âœ… **ç”¨æˆ·ç®¡ç†** - æ³¨å†Œã€ç™»å½•ã€ä¼šè¯ç®¡ç†
- âœ… **æ”¶æ”¯è®°å½•** - å®Œæ•´çš„CRUDæ“ä½œï¼ˆæ·»åŠ ã€æŸ¥çœ‹ã€ä¿®æ”¹ã€åˆ é™¤ï¼‰
- âœ… **ç±»åˆ«ç®¡ç†** - è‡ªå®šä¹‰æ”¶æ”¯ç±»åˆ«
- âœ… **æ•°æ®ç»Ÿè®¡** - æ—¥/å‘¨/æœˆç»Ÿè®¡ã€é‡‘é¢èŒƒå›´åˆ†æ
- âœ… **æ•°æ®æŒä¹…åŒ–** - SQLiteæœ¬åœ°å­˜å‚¨ï¼Œé‡å¯æ•°æ®ä¸ä¸¢å¤±

### ğŸš€ è¿›é˜¶å®ç°
- âœ… **å¤šç”¨æˆ·æ”¯æŒ** - å®Œæ•´çš„å¤šç”¨æˆ·éš”ç¦»ç³»ç»Ÿ
- âœ… **é«˜ç²¾åº¦è¿ç®—** - åŸºäºåˆ†çš„é‡‘é¢å­˜å‚¨ï¼Œé¿å…æµ®ç‚¹è¯¯å·®
- âœ… **å®‰å…¨æ¶æ„** - ä¼šè¯ç®¡ç†ã€å¯†ç åŠ å¯†ã€é”™è¯¯å¤„ç†
- âœ… **RESTful API** - æ¸…æ™°çš„æ¥å£è®¾è®¡ï¼Œæ˜“äºæ‰©å±•

## ğŸ›  æŠ€æœ¯æ ˆ

**åç«¯æ¡†æ¶**
- Go 1.21+ 
- Gin Web Framework
- SQLite3 æ•°æ®åº“

**å®‰å…¨ä¸æ¶æ„**
- Bcrypt å¯†ç åŠ å¯†
- æ•°æ®åº“ä¼šè¯ç®¡ç†
- ç»Ÿä¸€é”™è¯¯å¤„ç†
- ä¸­é—´ä»¶è®¤è¯

## ğŸ— æ¶æ„è®¾è®¡æ€è·¯
### åˆ†å±‚æ¶æ„
```text
HTTPå±‚ (handlers) â†’ ä¸šåŠ¡å±‚ (services) â†’ æ•°æ®å±‚ (database) â†’ æ•°æ®åº“
```
### æ‰©å±•æ€§è€ƒè™‘
**æ¨¡å—åŒ–è®¾è®¡** - å„åŠŸèƒ½æ¨¡å—ç‹¬ç«‹ï¼Œæ˜“äºç»´æŠ¤
**æ¥å£æ¸…æ™°** - æ˜ç¡®çš„å±‚é—´è¾¹ç•Œï¼Œä¾¿äºæµ‹è¯•
**é”™è¯¯å¤„ç†** - ç»Ÿä¸€é”™è¯¯ç ï¼Œä¾¿äºå‰ç«¯å¤„ç†
**æ•°æ®éš”ç¦»** - ä¸ºåç»­åŠŸèƒ½æ‰©å±•é¢„ç•™ç©ºé—´

## ğŸ“Š è®¾è®¡æ€è€ƒæ–‡æ¡£
åœ¨å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯¹å…³é”®é—®é¢˜çš„æ€è€ƒç¬”è®°
>æœªä»”ç»†æ ¸å¯¹å®é™…å®ç°å®Œå…¨ä¸€è‡´

[é‡‘é¢å¤„ç†è®¾è®¡æ€è·¯](./log_txt/add_amount_processing.txt) - ç²¾ç¡®è®¡ç®—æ–¹æ¡ˆ
[ç±»åˆ«ç®¡ç†æ¶æ„](./log_txt/category_management_design%20.txt) - æ•°æ®å…³ç³»è®¾è®¡
é”™è¯¯å¤„ç†è§„èŒƒ - ç”¨æˆ·ä½“éªŒä¼˜åŒ–

## ğŸ“ é¡¹ç›®ç»“æ„
AccountingAssistant/
â”œâ”€â”€ database/ # æ•°æ®è®¿é—®å±‚
â”‚ â”œâ”€â”€ master.go # ä¸»æ•°æ®åº“åˆå§‹åŒ–
â”‚ â”œâ”€â”€ user_db.go # ç”¨æˆ·æ•°æ®åº“æ“ä½œ
â”‚ â”œâ”€â”€ transaction_db.go
â”‚ â”œâ”€â”€ category_db.go
â”‚ â””â”€â”€ stats_db.go
â”œâ”€â”€ handlers/ # HTTPå¤„ç†å™¨
â”‚ â”œâ”€â”€ auth_handler.go
â”‚ â”œâ”€â”€ transaction_handler.go
â”‚ â”œâ”€â”€ category_handler.go
â”‚ â””â”€â”€ stats_handler.go
â”œâ”€â”€ models/ # æ•°æ®æ¨¡å‹
â”‚ â””â”€â”€ models.go
â”œâ”€â”€ services/ # ä¸šåŠ¡é€»è¾‘å±‚
â”‚ â”œâ”€â”€ auth_services.go
â”‚ â”œâ”€â”€ transaction_service.go
â”‚ â”œâ”€â”€ category_services.go
â”‚ â”œâ”€â”€ stats_service.go
â”‚ â””â”€â”€ session_service.go
â”œâ”€â”€ utils/ # å·¥å…·åŒ…
â”‚ â”œâ”€â”€ errors.go # ç»Ÿä¸€é”™è¯¯å¤„ç†
â”‚ â”œâ”€â”€ amount.go # é‡‘é¢ç²¾ç¡®å¤„ç†
â”‚ â”œâ”€â”€ amount_test.go
â”‚ â””â”€â”€ password.go # å¯†ç åŠ å¯†
â””â”€â”€ web/
  â”œâ”€â”€ middleware/ # ä¸­é—´ä»¶
  â”‚     â””â”€â”€ session.go
  â””â”€â”€ response/ # HTTPå“åº”å¤„ç†
        â””â”€â”€ response.go

## ğŸ” å®‰å…¨è®¾è®¡äº®ç‚¹

### 1. å¯†ç å®‰å…¨
```go
// ä½¿ç”¨bcryptè¿›è¡Œå¯†ç å“ˆå¸Œ
func HashPassword(password string) (string, error) {
    bytes, err := bcrypt.GenerateFromPassword([]byte(password), bcrypt.DefaultCost)
    return string(bytes), err
}
```
### 2. ä¼šè¯ç®¡ç†
- åŸºäºæ•°æ®åº“çš„ä¼šè¯å­˜å‚¨
- ä¸­é—´ä»¶ç»Ÿä¸€éªŒè¯
### 3. æ•°æ®éš”ç¦»
```go
// æ¯ä¸ªç”¨æˆ·ç‹¬ç«‹çš„æ•°æ®åº“æ–‡ä»¶
func GetUserDB(userId int64) (*sql.DB, error) {
    userDBPath := filepath.Join("database_files", "usersdata", fmt.Sprintf("user_%d.db", userId))
    // ...
}
```
### 4. ç»Ÿä¸€é”™è¯¯å¤„ç†
```go
// åˆ†çº§é”™è¯¯å¤„ç†æœºåˆ¶
func HandleError(c *gin.Context, err error) {
    // ä¸šåŠ¡é”™è¯¯ã€ç³»ç»Ÿé”™è¯¯ã€è®¤è¯é”™è¯¯åˆ†ç±»å¤„ç†
}
```
## ğŸ’° é‡‘é¢ç²¾ç¡®å¤„ç†è®¾è®¡
### é—®é¢˜èƒŒæ™¯
æµ®ç‚¹æ•°åœ¨é‡‘èè®¡ç®—ä¸­å­˜åœ¨ç²¾åº¦é—®é¢˜ï¼š
```go
// é”™è¯¯ç¤ºä¾‹
0.1 + 0.2 = 0.30000000000000004
```
### è§£å†³æ–¹æ¡ˆ
- å­—ç¬¦ä¸²ä¼ è¾“ - å‰åç«¯ä½¿ç”¨å­—ç¬¦ä¸²ä¼ é€’é‡‘é¢
- åˆ†å•ä½å­˜å‚¨ - æ•°æ®åº“ä¸­ä»¥åˆ†ä¸ºå•ä½å­˜å‚¨æ•´æ•°
- ç²¾ç¡®è½¬æ¢ - å››èˆäº”å…¥åˆ°åˆ†ï¼Œé¿å…ç´¯è®¡è¯¯å·®

```go
// æ ¸å¿ƒè½¬æ¢é€»è¾‘
func ParseToCents(str string) (int64, error) {
    // æ¸…ç†è¾“å…¥ â†’ éªŒè¯æ ¼å¼ â†’ å››èˆäº”å…¥ â†’ è½¬æ¢ä¸ºåˆ†
}
```
### å¤„ç†æµç¨‹
```text
ç”¨æˆ·è¾“å…¥ "123.456" 
â†’ æ¸…ç†ä¸º "123.456" 
â†’ å››èˆäº”å…¥ "123.46" 
â†’ è½¬æ¢ä¸ºåˆ† 12346
â†’ å­˜å‚¨ä¸ºæ•´æ•°
```

## ğŸš€ å¿«é€Ÿå¼€å§‹
### ç¯å¢ƒè¦æ±‚
- Go 1.21+
- SQLite3
### å®‰è£…è¿è¡Œ(ä»…ä¾›å‚è€ƒ)
```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>

# è¿›å…¥ç›®å½•
cd AccountingAssistant

# è¿è¡Œæµ‹è¯•
go test ./...

# å¯åŠ¨æœåŠ¡
go run main.go
```
### APIç¤ºä¾‹
#### ç”¨æˆ·æ³¨å†Œ

```http
POST /register
Content-Type: application/x-www-form-urlencoded

username=testuser&password=testpass
```
#### è®°å½•è´¦å•

```http
POST /transaction
Content-Type: application/x-www-form-urlencoded
Cookie: session_id=xxx

type=expense&amount=123.45&category=é¤é¥®&note=åˆé¤
```